<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pink Pomodoro Widget</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fce4ec; /* Light Pink */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* Prevent scroll */
        }

        .pomodoro-container {
            background-color: #f8bbd0; /* Medium Pink */
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 90%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-sizing: border-box; /* Include padding in width */
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mode-button {
            background-color: #e91e63; /* Dark Pink */
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            flex: 1; /* Distribute space evenly */
        }

        .mode-button:hover {
            background-color: #c2185b; /* Darker Pink on hover */
            transform: translateY(-2px);
        }

        .mode-button.active {
            background-color: #ad1457; /* Even Darker Pink for active */
            box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
        }

        .timer-display {
            font-size: 4em;
            font-weight: 700;
            color: #880e4f; /* Deep Pink */
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            letter-spacing: 2px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
        }

        .control-button {
            background-color: #ff69b4; /* Hot Pink */
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .control-button:hover {
            background-color: #ff4099; /* Slightly darker hot pink on hover */
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .control-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .pomodoro-container {
                padding: 20px;
                border-radius: 15px;
            }

            .timer-display {
                font-size: 3em;
            }

            .mode-button, .control-button {
                font-size: 0.9em;
                padding: 10px 15px;
            }

            .controls {
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="pomodoro-container">
        <div class="mode-selector">
            <button class="mode-button active" id="pomodoro-mode">Pomodoro</button>
            <button class="mode-button" id="short-break-mode">Short Break</button>
            <button class="mode-button" id="long-break-mode">Long Break</button>
        </div>

        <h1 class="timer-display" id="timer-display">25:00</h1>

        <div class="controls">
            <button class="control-button" id="start-button">Start</button>
            <button class="control-button" id="pause-button" style="display: none;">Pause</button>
            <button class="control-button" id="reset-button">Reset</button>
        </div>
    </div>

    <script>
        // Constants for time in seconds
        const POMODORO_TIME = 25 * 60;
        const SHORT_BREAK_TIME = 5 * 60;
        const LONG_BREAK_TIME = 15 * 60;

        // DOM elements
        const timerDisplay = document.getElementById('timer-display');
        const startButton = document.getElementById('start-button');
        const pauseButton = document.getElementById('pause-button');
        const resetButton = document.getElementById('reset-button');
        const pomodoroModeButton = document.getElementById('pomodoro-mode');
        const shortBreakModeButton = document.getElementById('short-break-mode');
        const longBreakModeButton = document.getElementById('long-break-mode');
        const modeButtons = document.querySelectorAll('.mode-button');

        // Timer variables
        let countdown;
        let timeLeft;
        let currentMode = 'pomodoro'; // pomodoro, shortBreak, longBreak
        let pomodoroCount = 0; // To track for long break

        // Function to format time for display (MM:SS)
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes < 10 ? '0' : ''}${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
        }

        // Function to update the timer display
        function updateDisplay() {
            timerDisplay.textContent = formatTime(timeLeft);
        }

        // Function to set the timer based on the current mode
        function setTimer(mode) {
            clearInterval(countdown); // Clear any existing countdown
            currentMode = mode;
            switch (mode) {
                case 'pomodoro':
                    timeLeft = POMODORO_TIME;
                    break;
                case 'shortBreak':
                    timeLeft = SHORT_BREAK_TIME;
                    break;
                case 'longBreak':
                    timeLeft = LONG_BREAK_TIME;
                    break;
            }
            updateDisplay();
            startButton.style.display = 'inline-block';
            pauseButton.style.display = 'none';
        }

        // Function to switch modes and update active button
        function switchMode(mode) {
            modeButtons.forEach(button => button.classList.remove('active'));
            if (mode === 'pomodoro') {
                pomodoroModeButton.classList.add('active');
            } else if (mode === 'shortBreak') {
                shortBreakModeButton.classList.add('active');
            } else if (mode === 'longBreak') {
                longBreakModeButton.classList.add('active');
            }
            setTimer(mode);
        }

        // Function to start the timer
        function startTimer() {
            startButton.style.display = 'none';
            pauseButton.style.display = 'inline-block';
            countdown = setInterval(() => {
                timeLeft--;
                updateDisplay();

                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    playAlarmSound();
                    handleSessionEnd();
                }
            }, 1000);
        }

        // Function to pause the timer
        function pauseTimer() {
            clearInterval(countdown);
            startButton.style.display = 'inline-block';
            pauseButton.style.display = 'none';
        }

        // Function to reset the timer
        function resetTimer() {
            clearInterval(countdown);
            setTimer(currentMode); // Reset to current mode's initial time
            startButton.style.display = 'inline-block';
            pauseButton.style.display = 'none';
        }

        // Function to play a simple sound when timer ends
        function playAlarmSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // A4 note
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.5, audioContext.currentTime + 0.1);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.5);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.5);
        }


        // Function to handle what happens when a session ends
        function handleSessionEnd() {
            if (currentMode === 'pomodoro') {
                pomodoroCount++;
                if (pomodoroCount % 4 === 0) {
                    switchMode('longBreak');
                } else {
                    switchMode('shortBreak');
                }
            } else {
                switchMode('pomodoro');
            }
            // Optionally, you could show a message to the user here
            console.log(`Session ended. Switching to ${currentMode === 'pomodoro' ? 'work' : 'break'} mode.`);
        }

        // Event Listeners
        startButton.addEventListener('click', startTimer);
        pauseButton.addEventListener('click', pauseTimer);
        resetButton.addEventListener('click', resetTimer);

        pomodoroModeButton.addEventListener('click', () => {
            switchMode('pomodoro');
            pomodoroCount = 0; // Reset pomodoro count when manually switching modes
        });
        shortBreakModeButton.addEventListener('click', () => {
            switchMode('shortBreak');
        });
        longBreakModeButton.addEventListener('click', () => {
            switchMode('longBreak');
        });

        // Initialize the timer when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimer('pomodoro');
        });
    </script>
</body>
</html>
